---
description: Test-Driven Development (TDD) Practice
alwaysApply: false
---
# Rule: Test-Driven Development (TDD) Practice

## Intent
All development must follow Test-Driven Development principles: write tests first, then implement code to make tests pass, then refactor while maintaining test coverage.

## Core TDD Cycle
1. **RED**: Write a failing test that describes the desired behavior
2. **GREEN**: Write minimal code to make the test pass
3. **REFACTOR**: Improve code while ensuring tests still pass

## Required Workflow
### Before Implementation
- Write unit tests for all public functions/methods
- Write integration tests for API endpoints and components
- Write acceptance tests for user-facing features
- All tests must fail initially (RED state)

### During Implementation
- Write minimal code to make tests pass (GREEN state)
- Focus on functionality, not perfection
- Avoid over-engineering

### After Implementation
- Refactor code while maintaining test coverage
- Ensure all tests continue to pass
- Improve code readability and maintainability

## Test Coverage Requirements
- **Unit Tests**: 80%+ coverage for business logic
- **Integration Tests**: All API endpoints and component interactions
- **Acceptance Tests**: All user stories and acceptance criteria
- **Edge Cases**: Error handling, boundary conditions, and error states

## Testing Tools & Frameworks
- **Unit Tests**: Jest with React Testing Library
- **Integration Tests**: Jest with Supertest for APIs
- **E2E Tests**: Playwright for critical user flows
- **Coverage**: Jest coverage reporting

## Test Organization
```
__tests__/
├── unit/           # Unit tests for utilities, hooks, components
├── integration/    # API endpoint and component integration tests
├── e2e/           # End-to-end tests (when applicable)
└── fixtures/      # Test data and mocks
```

## Test Naming Convention
- Unit tests: `{component/function}.test.ts`
- Integration tests: `{feature}.integration.test.ts`
- E2E tests: `{user-flow}.e2e.test.ts`

## Mocking Strategy
- Mock external APIs and services
- Use MSW (Mock Service Worker) for API mocking
- Avoid mocking internal business logic
- Prefer real implementations over mocks when possible

## CI/CD Integration
- Tests run automatically on every push
- PRs blocked if tests fail or coverage drops below threshold
- Coverage reports generated and tracked

## Exceptions
- **Spike/Prototype Code**: May skip TDD for exploratory work (must be marked as such)
- **Legacy Code**: Follow "Sprout Method" pattern - add tests around new code
- **UI Polish**: Minor styling changes may skip detailed tests

## Enforcement
- **Pre-commit**: All tests must pass locally
- **PR Review**: Test coverage and quality review required
- **CI Failure**: Blocks deployment if tests fail
- **Code Review**: Tests reviewed alongside implementation

## Benefits Tracked
- **Defect Rate**: Monitor bugs found vs. prevented by tests
- **Refactoring Confidence**: Track safe refactoring incidents
- **Development Speed**: Measure TDD overhead vs. benefits
- **Code Quality**: Track maintainability metrics